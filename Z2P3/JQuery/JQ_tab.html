<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JQuery Tab</title>
    
    <script type="text/javascript" src="jquery.min.js"></script>
    <script src="sweet_alert/sweetalert2.all.min.js"></script>
    <link rel="stylesheet" href="sweet_alert/sweetalert2.min.css">

    <style>
        ul.link-wapper {
            list-style-type: none;
            margin: 20px;
            padding: 0px;
            text-align: center;
        }

        ul.link-wapper li {
            display: inline-block;
            padding: 10px;
        }

        ul.link-wapper li a {
            text-decoration: none;
            color: black;
            padding: 10px;
        }

        ul.link-wapper li a.active {
            color: #0037ff;
            border-bottom: 1px solid red;
        }

        div.content {
            max-width: 500px;
            background-color: orange;
            padding: 20px 50px;
            margin: 0 auto 10px;
            display: none;
        }
    </style>
        
    <script type="text/javascript">
        $(function () {
            $(`.content`).first().slideDown();

            $(`ul.link-wapper li a`).on(`click`,function (event) {
                var current_tab = $(this)
                $(`ul.link-wapper li a`).removeClass(`active`);
                current_tab.addClass(`active`);

                $(`.content`).slideUp();
                current_tab_href = current_tab.attr(`href`);
                $(current_tab_href).slideDown();

                event.preventDefault();
            })

            //Local Storage
            $(`.atc`).on(`click`,function () {
                Swal.fire({
                    color: `green`,
                    position: 'center',
                    icon: 'success',
                    title: 'Item has been added to cart!',
                    showConfirmButton: false,
                    timer: 1500
                }) 

                let id = $(this).data(`id`)
                let name = $(this).data(`name`)
                let price = $(this).data(`price`)
                let item = {
                    id: id,
                    name: name,
                    price: price,
                    qty: 1
                }
                //console.log(price);
                //console.log(item);

                let cart = localStorage.getItem(`cart`)
                let myArr = ``

                if(cart != null){
                    myArr = JSON.parse(cart)
                }else{
                    myArr = []
                }

                //Homework
                let status = 0;
                for(row of myArr){
                    if(row.id == id){
                        row.qty++;
                        status = 1
                    }
                }
                if(status == 0){
                    myArr.push(item)
                }

                //JavaScript Object => JSON String
                let myArrString = JSON.stringify(myArr)
                //console.log(myArrString);
                localStorage.setItem(`cart`,myArrString)

                getdata()
            })

            //Get data from Local Storage
            function getdata() {
                let cart = localStorage.getItem(`cart`)
                if(cart != null){
                    let myArr = JSON.parse(cart)
                    let row = ``
                    let i = 0;
                    let total = 0;
                    for ([index,item] of myArr.entries()){
                        total += (item.qty*item.price)
                        row += `<tr>
                                <td>
                                    <button class="remove" data-id="${index}">Remove</button>
                                    ${++i}
                                </td>
                                <td>${item.name}</td>
                                <td>${item.price}</td>
                                <td>
                                    <input type="number" min="1" value="${item.qty}" data-id="${index}" class="updateqty">
                                </td>
                                <td>${item.qty*item.price}</td>
                            </tr>`
                }
                row += `<tr>
                            <td colspan="4">Total Amount</td>
                            <td>${total} Ks</td>
                        </tr>`

                $(`tbody`).html(row)
            }else{
                $(`tbody`).html(`<tr><td colspan="5">Your cart is empty!</td></tr>`)
            }
            }
            getdata();

            //Remove
            $(`tbody`).on(`click`,`.remove`,function () {
                let index = $(this).data(`id`)
                //console.log(index);
                let cart = localStorage.getItem(`cart`)
                let myArr = JSON.parse(cart);
                //Delete one row
                myArr.splice(index,1)
                //JS object => JSON String
                let myArrString = JSON.stringify(myArr)
                //console.log(myArrString);
                localStorage.setItem(`cart`,myArrString)
                getdata()
            })

            //Increase - Decrease Qty
            $(`tbody`).on(`change`,`.updateqty`,function () {
                let index = $(this).data(`id`)
                //console.log(index);
                let qty = $(this).val()
                let cart = localStorage.getItem(`cart`)
                let myArr = JSON.parse(cart)
                myArr[index].qty = qty
                //JS Object => JSON String
                let myArrString = JSON.stringify(myArr)
                //console.log(myArrString);
                localStorage.setItem(`cart`,myArrString)
                getdata()
            })

            //Checkout
            $(`.checkout`).on(`click`,function () {
                localStorage.removeItem(`cart`)
                getdata();
            })
        })
    </script>
</head>
<body>
    <div class="tab">
        <ul class="link-wapper">
            <li>
                <a href="#home" class="active">Home</a>
            </li>
            <li>
                <a href="#about">About</a>
            </li>
            <li>
                <a href="#contact">Contact</a>
            </li>
            <li>
                <a href="#shop">Shop</a>
            </li>
            <li>
                <a href="#cart">Cart</a>
            </li>
        </ul>

        <div class="content" id="home">
            <h3>Home Section</h3>
            <p>
                Lorem ipsum dolor sit amet consectetur adipisicing elit. Dolorum velit voluptas 
                laboriosam at, quod provident assumenda error dolor eum dicta magni possimus 
                sapiente ea ad, minima quidem alias. A, animi.
            </p>
        </div>

        <div class="content" id="about">
            <h3>About Section</h3>
            <p>
                Lorem ipsum dolor sit amet consectetur adipisicing elit. Dolorum velit voluptas 
                laboriosam at, quod provident assumenda error dolor eum dicta magni possimus 
                sapiente ea ad, minima quidem alias. A, animi.
            </p>
        </div>

        <div class="content" id="contact">
            <h3>Contact Section</h3>
            <p>
                Lorem ipsum dolor sit amet consectetur adipisicing elit. Dolorum velit voluptas 
                laboriosam at, quod provident assumenda error dolor eum dicta magni possimus 
                sapiente ea ad, minima quidem alias. A, animi.
            </p>
        </div>

        <div class="content" id="shop">
            <h3>Shop Section</h3>
            <div class="shop">
                <div class="item">
                    <img src="fruit.png" width="120px" height="70px">
                    <p>Item 1</p>
                    <strong>500 Ks</strong>
                    <button class="atc" data-id="1" data-name="Item One" 
                    data-price="500">Add to cart</button>
                </div>
                <div class="item">
                    <img src="fruit.png" width="120px" height="70px">
                    <p>Item 2</p>
                    <strong>1000 Ks</strong>
                    <button class="atc" data-id="2" data-name="Item Two" 
                    data-price="1000">Add to cart</button>
                </div>
                <div class="item">
                    <img src="fruit.png" width="120px" height="70px">
                    <p>Item 3</p>
                    <strong>200 Ks</strong>
                    <button class="atc" data-id="3" data-name="Item Three" 
                    data-price="200">Add to cart</button>
                </div>
            </div>
        </div>

        <div class="content" id="cart">
            <h3>Cart Section</h3>
            <div class="mycart">
                <table border="1" cellpadding="10" width="100%">
                    <thead>
                        <tr>
                            <th>No</th>
                            <th>Name</th>
                            <th>Price</th>
                            <th>Qty</th>
                            <th>Subtotal</th>
                        </tr>
                    </thead>
                    <tbody>
                        
                    </tbody>
                </table>
                <br><br>
                <button class="checkout" style="padding: 10px;">Checkout</button>
            </div>
        </div>
    </div>
</body>
</html>